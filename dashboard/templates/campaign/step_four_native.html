{% extends "layout.html" %}
{% from 'macros.html' import render_page_title, render_campaign_steps, render_form, render_campaign_steps_search_engine %}

{% block title %}
    {{ configs.page_title | default_title }}
{% endblock %}

{% block css %}
{% endblock %}

{% block content %}
    {{ render_page_title(configs.module, configs.url_index, configs.action) }}

    {% if configs.campaign_type_name == 'banner' or configs.campaign_type_name == 'mobile' or configs.campaign_type_name == 'native' %}
        {{ render_campaign_steps(configs.campaign_id,'active','active','active','current','','','') }}
    {% elif configs.campaign_type_name == 'search_engine' %}
        {{ render_campaign_steps_search_engine(configs.campaign_id,'active','active','active','current','','','') }}
    {% endif %}

    <style>
        .banner-size-item {
            width: 225px !important;
            height: 150px !important;
            margin: 40px auto 0 !important;
            float: none !important;
        }
    </style>

    <!-- BEGIN BASIC FORM ELEMENTS-->
    <div class="row">
        <div class="col-md-12">
            <div class="grid simple">
                <div class="grid-title no-border">
                    <h4>&nbsp;</h4>

                    <div class="tools">
                        <a href="javascript:;" class="collapse"></a>
                        <a href="#grid-config" data-toggle="modal" class="config"></a>
                        <a href="javascript:;" class="reload"></a>
                        <a href="javascript:;" class="remove"></a>
                    </div>
                </div>
                <div id="advertiser-campaign-step-four" class="grid-body no-border">

                    <form class="" method="POST"
                          action="{{ url_for('advertiser_campaign_steps', campaign_id=configs.campaign_id, campaign_step='four') }}"
                          role="form">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>

                        <div class="form-group title">
                            <label for="title" class="form-label">عنوان تبلیغ</label>
                            <span class="help"></span>
                            <div class="controls">
                                <div class="input-with-icon right">
                                    <i class=""></i>
                                    <input class="form-control" id="title" value="{{ title }}" name="title" placeholder="" type="text">
                                </div>
                            </div>
                        </div>

                        {% set banner_file = {'file': '', 'id':''} %}
                        {% for size in banner_sizes %}
                            {% if banner_file.update({'file':'', 'id':''}) %}
                            {% endif %}



                            {% for campaign_banner in campaign_banners %}
                                {% if campaign_banner['banner']['banner_size'] == size['banner_size_id'] %}
                                    {% if banner_file.update({'file': url_for('static', filename='uploads/'+campaign_banner['banner']['banner_file']['file_path']+'/'+campaign_banner['banner']['banner_file']['file_name']), 'id': campaign_banner['banner']['banner_id'] }) %}
                                    {% endif %}
                                {% endif %}
                            {% endfor %}



                            <div data-width="{{ size['banner_size_width'] }}"
                                 data-height="{{ size['banner_size_height'] }}"
                                 class="banner-size-item bnr{{ size["banner_size_width"] }}x{{ size["banner_size_height"] }}"
                                 style="background-image:url('{{ banner_file.file }}');width:{{ size["banner_size_width"] / 2 }}px;height:{{ size["banner_size_height"] / 2 }}px">
                                <div class="banner-size-content"{% if banner_file.file %}
                                     style="top:100%;transform:translateY(0%)" {% endif %}>
                                    <p>
                                        {{ size["banner_size_width"] }}
                                        در
                                        {{ size["banner_size_height"] }}
                                        پیکسل
                                    </p>
                                </div>
                                <input type="hidden" value="{{ banner_file.id }}" name="banners">
                                <div class="banner-size-toolbar">
                                    <a data-width="{{ size['banner_size_width'] }}"
                                       data-height="{{ size['banner_size_height'] }}" class="tool-icon-remove"
                                       href="javascript:void(0)"><i
                                            class="fa fa-times"></i></a>
                                </div>
                            </div>

                        {% endfor %}
                        <div class="clearfix"></div>
                        <button type="submit" class="btn btn-primary btn-cons">ثبت و ادامه</button>
                    </form>

                </div>
            </div>
        </div>
    </div>
    <!-- END BASIC FORM ELEMENTS-->

{% endblock %}

{% block js %}
    <script src="{{ url_for('static', filename='assets/js/form_validations.js') }}" type="text/javascript"></script>
    {% include 'uploads/banner.html' %}
{% endblock %}